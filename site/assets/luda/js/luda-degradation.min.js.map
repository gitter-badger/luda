{"version":3,"sources":["../../src/coffee/degradation.coffee"],"names":["Degradation","_URL_ATTRIBUTE","_HTML","join","_CSS_PROPERTIES","display","position","_JS_PROPERTIES","es6Class","es6ArrowFunction","mutationObserver","_NOTIFY_MILLSECONDS","check","this","_checkEnv","_checkJS","_checkCSS","_eval","eval","document","window","global","Error","properties","err","property","results","value","error","_notify","ele","i","len","name","valueEle","createElement","length","_CSSPropertySupported","results1","Array","results2","j","len1","_CSSValueSupported","style","_self","redirectUrl","ref","script","scripts","getAttribute","location","href","setInterval","getElementById","body","innerHTML"],"mappings":";;;;;2LAAA,IAAAA,YAAAA,YAEE,CAAAC,eAAgB,uBAEhBC,MAAO,CACL,mCACA,gDACA,oCACA,MACA,gDACA,4DACA,uBACA,OACA,QACA,UACEC,KAAK,IAETC,gBAAiB,CACf,CAAAC,QAAS,OACTC,SAAU,CAAC,SAAU,UACrB,aACA,aAGFC,eACE,CAAAC,SAAU,aACVC,iBAAkB,eAClBC,iBAAkB,sCAEpBC,oBAAqB,IAErBC,MAAO,WACLC,KAACC,YACDD,KAACE,SAASF,KAACN,uBACXM,KAACG,UAAUH,KAACT,kBAEda,MAAOC,KAEPJ,UAAW,WACT,UAAUK,WAAc,YAAxB,CACE,UAAwBC,SAAY,YAApC,CAAA,OAAOA,OACP,UAAwBC,SAAY,YAApC,CAAA,OAAOA,QACT,MAAM,IAAIC,MAAM,qCAElBP,SAAU,SAACQ,YACT,IAAAC,IAAAC,SAAAC,QAAAC,MAAAD,QAAA,GAAA,IAAAD,YAAAF,WAAA,4BACE,iBACEV,KAACI,MAAMU,QADT,MAAAC,OAEMJ,IAAAI,MACJf,KAACgB,UACD,MAAM,IAAIP,MAAMG,SAAW,IAAMD,sBAEvCR,UAAW,SAACO,YACV,IAAAO,IAAAC,EAAAC,IAAAC,KAAAR,SAAAC,QAAAC,MAAAO,SAAAJ,IAAMX,SAASgB,cAAc,OAC7BT,QAAA,GAAA,IAAAK,EAAA,EAAAC,IAAAT,WAAAa,OAAAL,EAAAC,IAAAD,IAAA,wBACE,UAAUN,WAAY,SAAtB,cACEZ,KAACwB,sBAAsBP,IAAKL,eAD9B,sCAGEa,SAAA,GAAA,IAAAL,QAAAR,SAAA,sBACEZ,KAACwB,sBAAsBP,IAAKG,MAC5B,GAAGN,iBAAiBY,MAApB,8CAC0CC,SAAA,GAAA,IAAAC,EAAA,EAAAC,KAAAf,MAAAS,OAAAK,EAAAC,KAAAD,IAAA,iCAAxC5B,KAAC8B,mBAAmBb,IAAKG,KAAMC,4CADjC,eAGErB,KAAC8B,mBAAmBb,IAAKG,KAAMN,uDAEzCU,sBAAuB,SAACP,IAAKL,UAC3B,UAAcK,IAAIc,MAAMnB,YAAa,SAArC,CACEZ,KAACgB,UACD,MAAM,IAAIP,MAAM,6BAA+BG,YAEnDkB,mBAAoB,SAACb,IAAKL,SAAUE,OAClCG,IAAIc,MAAMnB,UAAYE,MACtB,GAAOG,IAAIc,MAAMnB,YAAaE,MAA9B,CACEd,KAACgB,UACD,MAAM,IAAIP,MAAM,mCACdG,SAAW,IAAME,SAEvBE,QAAS,WACP,IAAAgB,MAAAd,EAAAC,IAAAc,YAAAC,IAAAC,OAAAD,IAAA5B,SAAA8B,QAAA,IAAAlB,EAAA,EAAAC,IAAAe,IAAAX,OAAAL,EAAAC,IAAAD,IAAA,eACEe,YAAcE,OAAOE,aAAarC,KAACZ,gBACnC,GAAsC6C,YAAtC,CAAA,OAAOK,SAASC,KAAON,aACzBD,MAAQhC,YACRwC,YAAY,WACV,IAAOlC,SAASmC,eAAe,yBAA/B,CACE,GAAyCnC,SAASoC,KAAlD,QAAApC,SAASoC,KAAKC,UAAYX,MAAM3C,SAClCW,KAACF,uBAKPX,YAAYY","sourcesContent":["Degradation =\n\n  _URL_ATTRIBUTE: 'data-degradation-url'\n\n  _HTML: [\n    '<div id=\"luda-degradation-html\" '\n    'style=\"padding:100px 30px;text-align:center\">'\n    '<h1>Your Browser Is Too Old!</h1>'\n    '<p>'\n    'Please visit this site with a modern browser '\n    '<a target=\"_blank\" href=\"https://www.google.com/chrome/\">'\n    '(Chrome recommended)'\n    '</a>'\n    '.</p>'\n    '</div>'\n    ].join('')\n\n  _CSS_PROPERTIES: [\n    display: 'flex'\n    position: ['sticky', 'fixed']\n    'transition'\n    'animation'\n  ]\n\n  _JS_PROPERTIES:\n    es6Class: 'class X {}'\n    es6ArrowFunction: '((x) => x)()'\n    mutationObserver: 'new MutationObserver(function(){})'\n\n  _NOTIFY_MILLSECONDS: 500\n\n  check: ->\n    @_checkEnv()\n    @_checkJS @_JS_PROPERTIES\n    @_checkCSS @_CSS_PROPERTIES\n\n  _eval: eval\n\n  _checkEnv: ->\n    if typeof document isnt 'undefined'\n      return window if typeof window isnt 'undefined'\n      return global if typeof global isnt 'undefined'\n    throw new Error 'Unsupported runtime environment.'\n\n  _checkJS: (properties) ->\n    for property, value of properties\n      try\n        @_eval value\n      catch err\n        @_notify()\n        throw new Error property + ' ' + err\n\n  _checkCSS: (properties) ->\n    ele = document.createElement 'div'\n    for property in properties\n      if typeof property is 'string'\n        @_CSSPropertySupported ele, property\n      else\n        for name, value of property\n          @_CSSPropertySupported ele, name\n          if value instanceof Array\n            @_CSSValueSupported ele, name, valueEle for valueEle in value\n          else\n            @_CSSValueSupported ele, name, value\n\n  _CSSPropertySupported: (ele, property) ->\n    unless typeof ele.style[property] is 'string'\n      @_notify()\n      throw new Error 'Unsupported CSS property: ' + property\n\n  _CSSValueSupported: (ele, property, value) ->\n    ele.style[property] = value\n    unless ele.style[property] is value\n      @_notify()\n      throw new Error 'Unsupported CSS property value: ' \\\n      + property + ' ' + value\n\n  _notify: ->\n    for script in document.scripts\n      redirectUrl = script.getAttribute @_URL_ATTRIBUTE\n      return location.href = redirectUrl if redirectUrl\n    _self = this\n    setInterval(->\n      unless document.getElementById 'luda-degradation-html'\n        document.body.innerHTML = _self._HTML if document.body\n    , @_NOTIFY_MILLSECONDS)\n\n\n\n\nDegradation.check()"]}