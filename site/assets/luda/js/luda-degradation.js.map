{"version":3,"file":"luda-degradation.js","sources":["../../src/coffee/degradation.coffee"],"sourcesContent":["Degradation =\r\n\r\n  _URL_ATTRIBUTE: 'data-degradation-url'\r\n\r\n  _HTML: [\r\n    '<div id=\"luda-degradation-html\" '\r\n    'style=\"padding:100px 30px;text-align:center\">'\r\n    '<h1>Your Browser Is Too Old!</h1>'\r\n    '<p>'\r\n    'Please visit this site with a modern browser '\r\n    '<a target=\"_blank\" href=\"https://www.google.com/chrome/\">'\r\n    '(Chrome recommended)'\r\n    '</a>'\r\n    '.</p>'\r\n    '</div>'\r\n    ].join('')\r\n\r\n  _CSS_PROPERTIES: [\r\n    display: 'flex'\r\n    position: ['sticky', 'fixed']\r\n    'transition'\r\n    'animation'\r\n  ]\r\n\r\n  _JS_PROPERTIES:\r\n    es6Class: 'class X {}'\r\n    es6ArrowFunction: '((x) => x)()'\r\n    mutationObserver: 'new MutationObserver(function(){})'\r\n\r\n  _NOTIFY_MILLSECONDS: 500\r\n\r\n  check: ->\r\n    @_checkEnv()\r\n    @_checkJS @_JS_PROPERTIES\r\n    @_checkCSS @_CSS_PROPERTIES\r\n\r\n  _eval: eval\r\n\r\n  _checkEnv: ->\r\n    if typeof document isnt 'undefined'\r\n      return window if typeof window isnt 'undefined'\r\n      return global if typeof global isnt 'undefined'\r\n    throw new Error 'Unsupported runtime environment.'\r\n\r\n  _checkJS: (properties) ->\r\n    for property, value of properties\r\n      try\r\n        @_eval value\r\n      catch err\r\n        @_notify()\r\n        throw new Error property + ' ' + err\r\n\r\n  _checkCSS: (properties) ->\r\n    ele = document.createElement 'div'\r\n    for property in properties\r\n      if typeof property is 'string'\r\n        @_CSSPropertySupported ele, property\r\n      else\r\n        for name, value of property\r\n          @_CSSPropertySupported ele, name\r\n          if value instanceof Array\r\n            @_CSSValueSupported ele, name, valueEle for valueEle in value\r\n          else\r\n            @_CSSValueSupported ele, name, value\r\n\r\n  _CSSPropertySupported: (ele, property) ->\r\n    unless typeof ele.style[property] is 'string'\r\n      @_notify()\r\n      throw new Error 'Unsupported CSS property: ' + property\r\n\r\n  _CSSValueSupported: (ele, property, value) ->\r\n    ele.style[property] = value\r\n    unless ele.style[property] is value\r\n      @_notify()\r\n      throw new Error 'Unsupported CSS property value: ' \\\r\n      + property + ' ' + value\r\n\r\n  _notify: ->\r\n    redirectUrl = document.documentElement.getAttribute @_URL_ATTRIBUTE\r\n    return location.href = redirectUrl if redirectUrl\r\n    _self = this\r\n    setInterval(->\r\n      unless document.getElementById 'luda-degradation-html'\r\n        document.body.innerHTML = _self._HTML if document.body\r\n    , @_NOTIFY_MILLSECONDS)\r\n\r\n\r\n\r\n\r\nDegradation.check()"],"names":[],"mappings":"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"}