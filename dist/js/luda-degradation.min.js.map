{"version":3,"sources":["../../src/coffee/degradation.coffee"],"names":["Degradation","_URL_ATTRIBUTE","_HTML","join","_CSS_PROPERTIES","display","position","_JS_PROPERTIES","es6Class","es6ArrowFunction","mutationObserver","_NOTIFY_MILLSECONDS","check","this","_checkEnv","_checkJS","_checkCSS","_eval","eval","document","window","global","Error","properties","err","property","results","value","error","_notify","ele","i","len","name","valueEle","createElement","length","_CSSPropertySupported","results1","Array","results2","j","len1","_CSSValueSupported","style","valueStr","values","split","_self","redirectUrl","ref","script","documentElement","getAttribute","location","href","scripts","setInterval","getElementById","body","innerHTML"],"mappings":";;;;;2LAAA,IAAAA,YAAAA,YAEE,CAAAC,eAAgB,uBAEhBC,MAAO,CACL,mCACA,gDACA,oCACA,MACA,gDACA,4DACA,uBACA,OACA,QACA,UACEC,KAAK,IAETC,gBAAiB,CACf,CAAAC,QAAS,OACTC,SAAU,CAAC,yBAA0B,UACrC,aACA,aAGFC,eACE,CAAAC,SAAU,aACVC,iBAAkB,eAClBC,iBAAkB,sCAEpBC,oBAAqB,IAErBC,MAAO,WACLC,KAACC,YACDD,KAACE,SAASF,KAACN,uBACXM,KAACG,UAAUH,KAACT,kBAEda,MAAOC,KAEPJ,UAAW,WACT,UAAUK,WAAc,YAAxB,CACE,UAAwBC,SAAY,YAApC,CAAA,OAAOA,OACP,UAAwBC,SAAY,YAApC,CAAA,OAAOA,QACT,MAAM,IAAIC,MAAM,qCAElBP,SAAU,SAACQ,YACT,IAAAC,IAAAC,SAAAC,QAAAC,MAAAD,QAAA,GAAA,IAAAD,YAAAF,WAAA,4BACE,iBACEV,KAACI,MAAMU,QADT,MAAAC,OAEMJ,IAAAI,MACJf,KAACgB,UACD,MAAM,IAAIP,MAAMG,SAAW,IAAMD,sBAEvCR,UAAW,SAACO,YACV,IAAAO,IAAAC,EAAAC,IAAAC,KAAAR,SAAAC,QAAAC,MAAAO,SAAAJ,IAAMX,SAASgB,cAAc,OAC7BT,QAAA,GAAA,IAAAK,EAAA,EAAAC,IAAAT,WAAAa,OAAAL,EAAAC,IAAAD,IAAA,wBACE,UAAUN,WAAY,SAAtB,cACEZ,KAACwB,sBAAsBP,IAAKL,eAD9B,sCAGEa,SAAA,GAAA,IAAAL,QAAAR,SAAA,sBACEZ,KAACwB,sBAAsBP,IAAKG,MAC5B,GAAGN,iBAAiBY,MAApB,8CAC0CC,SAAA,GAAA,IAAAC,EAAA,EAAAC,KAAAf,MAAAS,OAAAK,EAAAC,KAAAD,IAAA,iCAAxC5B,KAAC8B,mBAAmBb,IAAKG,KAAMC,4CADjC,eAGErB,KAAC8B,mBAAmBb,IAAKG,KAAMN,uDAEzCU,sBAAuB,SAACP,IAAKL,UAC3B,UAAcK,IAAIc,MAAMnB,YAAa,SAArC,CACEZ,KAACgB,UACD,MAAM,IAAIP,MAAM,6BAA+BG,YAEnDkB,mBAAoB,SAACb,IAAKL,SAAUoB,UAClC,IAAAd,EAAAC,IAAAL,MAAAmB,OAAAA,OAASD,SAASE,MAAM,MACxB,IAAAhB,EAAA,EAAAC,IAAAc,OAAAV,OAAAL,EAAAC,IAAAD,IAAA,iBACED,IAAIc,MAAMnB,UAAYE,MACtB,GAAUG,IAAIc,MAAMnB,YAAaE,MAAjC,CAAA,QACFd,KAACgB,UACD,MAAM,IAAIP,MAAM,mCACdG,SAAW,IAAMoB,WAErBhB,QAAS,WACP,IAAAmB,MAAAjB,EAAAC,IAAAiB,YAAAC,IAAAC,OAAAF,YAAc9B,SAASiC,gBAAgBC,aAAaxC,KAACZ,gBACrD,GAAsCgD,YAAtC,CAAA,OAAOK,SAASC,KAAON,YACvBC,IAAA/B,SAAAqC,QAAA,IAAAzB,EAAA,EAAAC,IAAAkB,IAAAd,OAAAL,EAAAC,IAAAD,IAAA,eACEkB,YAAcE,OAAOE,aAAaxC,KAACZ,gBACnC,GAAsCgD,YAAtC,CAAA,OAAOK,SAASC,KAAON,aACzBD,MAAQnC,YACR4C,YAAY,WACV,IAAOtC,SAASuC,eAAe,yBAA/B,CACE,GAAyCvC,SAASwC,KAAlD,QAAAxC,SAASwC,KAAKC,UAAYZ,MAAM9C,SAClCW,KAACF,uBAKPX,YAAYY","sourcesContent":["Degradation =\r\n\r\n  _URL_ATTRIBUTE: 'data-degradation-url'\r\n\r\n  _HTML: [\r\n    '<div id=\"luda-degradation-html\" '\r\n    'style=\"padding:100px 30px;text-align:center\">'\r\n    '<h1>Your Browser Is Too Old!</h1>'\r\n    '<p>'\r\n    'Please visit this site with a modern browser '\r\n    '<a target=\"_blank\" href=\"https://www.google.com/chrome/\">'\r\n    '(Chrome recommended)'\r\n    '</a>'\r\n    '.</p>'\r\n    '</div>'\r\n    ].join('')\r\n\r\n  _CSS_PROPERTIES: [\r\n    display: 'flex'\r\n    position: ['sticky||-webkit-sticky', 'fixed']\r\n    'transition'\r\n    'animation'\r\n  ]\r\n\r\n  _JS_PROPERTIES:\r\n    es6Class: 'class X {}'\r\n    es6ArrowFunction: '((x) => x)()'\r\n    mutationObserver: 'new MutationObserver(function(){})'\r\n\r\n  _NOTIFY_MILLSECONDS: 500\r\n\r\n  check: ->\r\n    @_checkEnv()\r\n    @_checkJS @_JS_PROPERTIES\r\n    @_checkCSS @_CSS_PROPERTIES\r\n\r\n  _eval: eval\r\n\r\n  _checkEnv: ->\r\n    if typeof document isnt 'undefined'\r\n      return window if typeof window isnt 'undefined'\r\n      return global if typeof global isnt 'undefined'\r\n    throw new Error 'Unsupported runtime environment.'\r\n\r\n  _checkJS: (properties) ->\r\n    for property, value of properties\r\n      try\r\n        @_eval value\r\n      catch err\r\n        @_notify()\r\n        throw new Error property + ' ' + err\r\n\r\n  _checkCSS: (properties) ->\r\n    ele = document.createElement 'div'\r\n    for property in properties\r\n      if typeof property is 'string'\r\n        @_CSSPropertySupported ele, property\r\n      else\r\n        for name, value of property\r\n          @_CSSPropertySupported ele, name\r\n          if value instanceof Array\r\n            @_CSSValueSupported ele, name, valueEle for valueEle in value\r\n          else\r\n            @_CSSValueSupported ele, name, value\r\n\r\n  _CSSPropertySupported: (ele, property) ->\r\n    unless typeof ele.style[property] is 'string'\r\n      @_notify()\r\n      throw new Error 'Unsupported CSS property: ' + property\r\n\r\n  _CSSValueSupported: (ele, property, valueStr) ->\r\n    values = valueStr.split '||'\r\n    for value in values\r\n      ele.style[property] = value\r\n      return if ele.style[property] is value\r\n    @_notify()\r\n    throw new Error 'Unsupported CSS property value: ' \\\r\n    + property + ' ' + valueStr\r\n\r\n  _notify: ->\r\n    redirectUrl = document.documentElement.getAttribute @_URL_ATTRIBUTE\r\n    return location.href = redirectUrl if redirectUrl\r\n    for script in document.scripts\r\n      redirectUrl = script.getAttribute @_URL_ATTRIBUTE\r\n      return location.href = redirectUrl if redirectUrl\r\n    _self = this\r\n    setInterval(->\r\n      unless document.getElementById 'luda-degradation-html'\r\n        document.body.innerHTML = _self._HTML if document.body\r\n    , @_NOTIFY_MILLSECONDS)\r\n\r\n\r\n\r\n\r\nDegradation.check()"]}