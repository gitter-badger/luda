{"version":3,"file":"luda-degradation.js","sources":["../../src/coffee/degradation.coffee"],"sourcesContent":["Degradation =\n\n  _URL_ATTRIBUTE: 'data-degradation-url'\n\n  _HTML: [\n    '<div id=\"luda-degradation-html\" '\n    'style=\"padding:100px 30px;text-align:center\">'\n    '<h1>Your Browser Is Too Old!</h1>'\n    '<p>'\n    'Please visit this site with a modern browser '\n    '<a target=\"_blank\" href=\"https://www.google.com/chrome/\">'\n    '(Chrome recommended)'\n    '</a>'\n    '.</p>'\n    '</div>'\n    ].join('')\n\n  _CSS_PROPERTIES: [\n    display: 'flex'\n    position: ['sticky||-webkit-sticky', 'fixed']\n    'transition'\n    'animation'\n  ]\n\n  _JS_PROPERTIES:\n    es6Class: 'class X {}'\n    es6ArrowFunction: '((x) => x)()'\n    mutationObserver: 'new MutationObserver(function(){})'\n\n  _NOTIFY_MILLSECONDS: 500\n\n  check: ->\n    @_checkEnv()\n    @_checkJS @_JS_PROPERTIES\n    @_checkCSS @_CSS_PROPERTIES\n\n  _eval: eval\n\n  _checkEnv: ->\n    if typeof document isnt 'undefined'\n      return window if typeof window isnt 'undefined'\n      return global if typeof global isnt 'undefined'\n    throw new Error 'Unsupported runtime environment.'\n\n  _checkJS: (properties) ->\n    for property, value of properties\n      try\n        @_eval value\n      catch err\n        @_notify()\n        throw new Error property + ' ' + err\n\n  _checkCSS: (properties) ->\n    ele = document.createElement 'div'\n    for property in properties\n      if typeof property is 'string'\n        @_CSSPropertySupported ele, property\n      else\n        for name, value of property\n          @_CSSPropertySupported ele, name\n          if value instanceof Array\n            @_CSSValueSupported ele, name, valueEle for valueEle in value\n          else\n            @_CSSValueSupported ele, name, value\n\n  _CSSPropertySupported: (ele, property) ->\n    unless typeof ele.style[property] is 'string'\n      @_notify()\n      throw new Error 'Unsupported CSS property: ' + property\n\n  _CSSValueSupported: (ele, property, valueStr) ->\n    values = valueStr.split '||'\n    for value in values\n      ele.style[property] = value\n      return if ele.style[property] is value\n    @_notify()\n    throw new Error 'Unsupported CSS property value: ' \\\n    + property + ' ' + valueStr\n\n  _notify: ->\n    redirectUrl = document.documentElement.getAttribute @_URL_ATTRIBUTE\n    return location.href = redirectUrl if redirectUrl\n    for script in document.scripts\n      redirectUrl = script.getAttribute @_URL_ATTRIBUTE\n      return location.href = redirectUrl if redirectUrl\n    _self = this\n    setInterval(->\n      unless document.getElementById 'luda-degradation-html'\n        document.body.innerHTML = _self._HTML if document.body\n    , @_NOTIFY_MILLSECONDS)\n\n\n\n\nDegradation.check()"],"names":[],"mappings":"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"}